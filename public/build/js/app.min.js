let sectionStep=1;const initialStep=1,lastStep=3,appointment={id:"",name:"",date:"",hour:"",services:[]};function startApp(){showSection(),tabs(),paginatorBtns(),updatePage(),fetchAPI(),customerInfo(),chooseDate(),chooseHour(),showSummary()}function showSection(){const e=document.querySelector(".section.show")||null;e&&e.classList.remove("show");const t=document.getElementById(`step-${sectionStep}`)||null;t&&t.classList.add("show")}function tabs(){document.getElementById("tabs").addEventListener("click",(function(e){if(!e.target.classList.contains("tab"))return;const t=e.target;sectionStep=parseInt(t.dataset.step,10)||null,updateCurrentTabStyle(),showSection(),paginatorBtns()}))}function paginatorBtns(){const e=document.getElementById("next"),t=document.getElementById("previous");1===sectionStep?(t.classList.add("hide"),e.classList.remove("hide")):3===sectionStep?(e.classList.add("hide"),t.classList.remove("hide"),showSummary()):(t.classList.remove("hide"),e.classList.remove("hide")),showSection(),updateCurrentTabStyle()}function updateCurrentTabStyle(){const e=document.querySelector(".tab-current")||null;e&&e.classList.remove("tab-current");document.querySelector(`[data-step="${sectionStep}"]`).classList.add("tab-current")}function updatePage(){const e=document.getElementById("next");document.getElementById("previous").addEventListener("click",(function(){sectionStep<=1||(sectionStep--,paginatorBtns())})),e.addEventListener("click",(function(){sectionStep>=3||(sectionStep++,paginatorBtns())}))}async function fetchAPI(){try{const e="http://localhost:3000/api/services",t=await fetch(e);showServices(await t.json())}catch(e){console.log(new Error(e))}}function showServices(e){const t=document.getElementById("service-container")||null;t&&e.forEach((e=>{const{id:n,name:o,price:s}=e,c=document.createElement("DIV");c.dataset.serviceId=n,c.classList.add("service"),c.onclick=()=>{pickService(e)};const a=document.createElement("P");a.textContent=o,a.classList.add("service__name");const i=document.createElement("P");i.textContent=s,i.classList.add("service__price"),c.append(a,i),t.append(c)}))}function pickService(e){const{services:t}=appointment,{id:n}=e,o=document.querySelector(`[data-service-id='${n}']`)||null;if(t.some((e=>e.id===n))){const e=t.filter((e=>e.id!==n));return appointment.services=e,void(o&&o.classList.remove("selected"))}appointment.services=[...t,e],o&&o.classList.add("selected")}function customerInfo(){appointment.name=document.getElementById("customer-name").value||"",appointment.id=document.querySelector(".user-id").value||""}function chooseDate(){const e=document.getElementById("date")||null;e&&e.addEventListener("input",(function(){const[e,t,n]=this.value.split("-"),o=new Date(e,t-1,n),s=new Date,c=o.getUTCDay();return[0,6].includes(c)?(this.value=appointment.date,void showAlert("No hay servicios los fines de semana","error",".alerts")):o.getDate()<=s.getDate()&&o.getMonth<=s.getMonth()||o.getTime()<=s.getTime()?(this.value=appointment.date,void showAlert("Fecha incorrecta","error",".alerts")):void(appointment.date=this.value)}))}function chooseHour(){const e=document.getElementById("time")||null;e&&e.addEventListener("input",(function(){const[e,t]=this.value.split(":");e<"08"||e>"17"||e>="17"&&t>"30"?(this.value="",showAlert("Servicio solo de 8:00am a 5:30pm","error",".alerts")):appointment.hour=this.value}))}function deleteAlert(e=null){e&&e.remove()}function showAlert(e="",t="",n="body",o=!1){const s=document.querySelector(".alert")||null;s&&deleteAlert(s);const c=document.createElement("div");c.classList.add("alert",t),c.innerText=e;const a=document.querySelector(n)||null;a&&(a.append(c),o||setTimeout((()=>{deleteAlert(c)}),6e3))}function showSummary(){const e=document.querySelector(".summary-content")||null;if(e)for(;e.firstChild;)e.firstChild.remove();if(Object.values(appointment).includes("")||0===appointment.services.length)return void showAlert("Faltan datos para la cita","error",".summary-content",!0);const{name:t,date:n,hour:o,services:s}=appointment,c=document.createElement("DIV");c.classList.add("appointment-services");const a=document.createElement("H3");a.textContent="Resumen de servicios",c.appendChild(a),s.forEach((e=>{const{name:t,price:n}=e,o=document.createElement("DIV");o.classList.add("service-element");const s=document.createElement("P");s.textContent=t;const a=document.createElement("P");a.innerHTML=`<span>Precio: </span> $${n}`,o.append(s,a),c.append(o)}));const i=document.createElement("DIV");i.classList.add("appointment-info");const r=document.createElement("H3");r.textContent="Resumen de la cita",i.appendChild(r);const d=document.createElement("P");d.innerHTML=`<span>Nombre:</span> ${t}`;const l=formatDate(n,"es-CO"),u=formatHour(o,"es-CO"),m=document.createElement("P");m.innerHTML=`<span>Fecha:</span> ${l}`;const p=document.createElement("P");p.innerHTML=`<span>Hora:</span> ${u}`,i.append(d,m,p);const h=document.createElement("BUTTON");h.classList.add("button","submit"),h.textContent="Reservar Cita",h.addEventListener("click",bookAppointment),e.append(c,i,h)}function formatDate(e,t){try{const[n,o,s]=e.split("-");return new Date(n,o-1,s).toLocaleDateString(t,{day:"numeric",weekday:"long",month:"long",year:"numeric"})}catch(t){return e}}function formatHour(e,t){try{const[n,o]=e.split(":");return new Date(0,0,0,n,o).toLocaleTimeString(t,{hour:"numeric",minute:"numeric",hour12:!0})}catch(t){return e}}async function bookAppointment(){const{id:e,date:t,name:n,hour:o,services:s}=appointment,c=s.map((e=>e.id)),a=new FormData;a.set("date",t),a.set("hour",o),a.set("userId",e),a.set("services",c);try{const e="http://localhost:3000/api/appointments",t=await fetch(e,{method:"post",body:a});(await t.json()).result&&Swal.fire({title:"Cita agendada correctamente!",text:"Gracias por usas nuestros servicios "+n+".",icon:"success"}).then((()=>{window.location.reload()}))}catch(e){Swal.fire({title:"Error",text:"Ocurrio un error. Intenta mÃ¡s tarde...",icon:"error"}).then((()=>{window.location.reload()}))}}Object.seal(appointment),document.addEventListener("DOMContentLoaded",(function(){startApp()}));
//# sourceMappingURL=app.min.js.map
